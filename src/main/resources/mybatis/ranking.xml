<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dev.mvc.rank.RankDAOInter"> <!-- SB가 자동으로 구현하여 연동하는 interface -->

<select id="ranking" resultType="dev.mvc.share_contentsdto.Share_contentsVO" parameterType="HashMap">
		SELECT scon_no, scon_title, scon_contents, scon_views, scon_comment,
		scon_date,scon_priority, r
		FROM (
		SELECT scon_no, scon_title,
		scon_contents, scon_views, scon_comment,
		scon_date,scon_priority,rownum as r
		FROM (
		SELECT scon_no, scon_title,
		scon_contents, scon_views, scon_comment,
		scon_date,scon_priority
		FROM
		share_contents
		<choose>
			<when test="word != null or word != ''">
				WHERE (UPPER(scon_title) LIKE '%' || UPPER(#{word})
				|| '%'
				OR UPPER(scon_contents) LIKE '%' || UPPER(#{word}) || '%'
				OR
				UPPER(word) LIKE '%' || UPPER(#{word}) || '%')
			</when>
			<otherwise>
				<!-- 조건이 없으면 모든 레코드 선택 -->
			</otherwise>
		</choose>
		ORDER BY scon_priority DESC
		)
		)
		WHERE r&lt;=10
</select>
</mapper>